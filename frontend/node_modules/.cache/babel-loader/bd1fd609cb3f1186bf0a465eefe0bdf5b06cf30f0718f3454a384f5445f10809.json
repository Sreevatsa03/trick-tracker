{"ast":null,"code":"var BufferReader = require('./lib/buffer-reader');\nvar XIPH_LACING = 1;\nvar EBML_LACING = 3;\nvar FIXED_SIZE_LACING = 2;\nmodule.exports = function (buffer) {\n  var block = {};\n  var reader = new BufferReader(buffer);\n  block.trackNumber = reader.nextUIntV();\n  block.timecode = reader.nextInt16BE();\n  var flags = reader.nextUInt8();\n  block.invisible = !!(flags & 0x8);\n\n  // only valid for SimpleBlock\n  block.keyframe = !!(flags & 0x80);\n  block.discardable = !!(flags & 0x1);\n  var lacing = (flags & 0x6) >> 1;\n  block.frames = readLacedData(reader, lacing);\n  return block;\n};\nfunction readLacedData(reader, lacing) {\n  if (!lacing) return [reader.nextBuffer()];\n  var i, frameSize;\n  var frames = [];\n  var framesNum = reader.nextUInt8() + 1; // number of frames\n\n  if (lacing === FIXED_SIZE_LACING) {\n    // remaining data should be divisible by the number of frames\n    if (reader.length % framesNum !== 0) throw new Error('Fixed-Size Lacing Error');\n    frameSize = reader.length / framesNum;\n    for (i = 0; i < framesNum; i++) {\n      frames.push(reader.nextBuffer(frameSize));\n    }\n    return frames;\n  }\n  var frameSizes = [];\n  if (lacing === XIPH_LACING) {\n    for (i = 0; i < framesNum - 1; i++) {\n      var val;\n      frameSize = 0;\n      do {\n        val = reader.nextUInt8();\n        frameSize += val;\n      } while (val === 0xff);\n      frameSizes.push(frameSize);\n    }\n  } else if (lacing === EBML_LACING) {\n    // first frame\n    frameSize = reader.nextUIntV();\n    frameSizes.push(frameSize);\n\n    // middle frames\n    for (i = 1; i < framesNum - 1; i++) {\n      frameSize += reader.nextIntV();\n      frameSizes.push(frameSize);\n    }\n  }\n  for (i = 0; i < framesNum - 1; i++) {\n    frames.push(reader.nextBuffer(frameSizes[i]));\n  }\n\n  // last frame (remaining buffer)\n  frames.push(reader.nextBuffer());\n  return frames;\n}","map":{"version":3,"names":["BufferReader","require","XIPH_LACING","EBML_LACING","FIXED_SIZE_LACING","module","exports","buffer","block","reader","trackNumber","nextUIntV","timecode","nextInt16BE","flags","nextUInt8","invisible","keyframe","discardable","lacing","frames","readLacedData","nextBuffer","i","frameSize","framesNum","length","Error","push","frameSizes","val","nextIntV"],"sources":["/Users/ruchireddy/trick-tracker/frontend/node_modules/ebml-block/index.js"],"sourcesContent":["var BufferReader = require('./lib/buffer-reader')\n\nvar XIPH_LACING = 1\nvar EBML_LACING = 3\nvar FIXED_SIZE_LACING = 2\n\nmodule.exports = function (buffer) {\n  var block = {}\n  var reader = new BufferReader(buffer)\n\n  block.trackNumber = reader.nextUIntV()\n  block.timecode = reader.nextInt16BE()\n\n  var flags = reader.nextUInt8()\n\n  block.invisible = !!(flags & 0x8)\n\n  // only valid for SimpleBlock\n  block.keyframe = !!(flags & 0x80)\n  block.discardable = !!(flags & 0x1)\n\n  var lacing = (flags & 0x6) >> 1\n\n  block.frames = readLacedData(reader, lacing)\n\n  return block\n}\n\nfunction readLacedData (reader, lacing) {\n  if (!lacing) return [reader.nextBuffer()]\n\n  var i, frameSize\n  var frames = []\n  var framesNum = reader.nextUInt8() + 1 // number of frames\n\n  if (lacing === FIXED_SIZE_LACING) {\n    // remaining data should be divisible by the number of frames\n    if (reader.length % framesNum !== 0) throw new Error('Fixed-Size Lacing Error')\n\n    frameSize = reader.length / framesNum\n    for (i = 0; i < framesNum; i++) {\n      frames.push(reader.nextBuffer(frameSize))\n    }\n    return frames\n  }\n\n  var frameSizes = []\n\n  if (lacing === XIPH_LACING) {\n    for (i = 0; i < framesNum - 1; i++) {\n      var val\n      frameSize = 0\n      do {\n        val = reader.nextUInt8()\n        frameSize += val\n      } while (val === 0xff)\n      frameSizes.push(frameSize)\n    }\n  } else if (lacing === EBML_LACING) {\n    // first frame\n    frameSize = reader.nextUIntV()\n    frameSizes.push(frameSize)\n\n    // middle frames\n    for (i = 1; i < framesNum - 1; i++) {\n      frameSize += reader.nextIntV()\n      frameSizes.push(frameSize)\n    }\n  }\n\n  for (i = 0; i < framesNum - 1; i++) {\n    frames.push(reader.nextBuffer(frameSizes[i]))\n  }\n\n  // last frame (remaining buffer)\n  frames.push(reader.nextBuffer())\n\n  return frames\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}